<div class="container-fluid" id="addTreatmentClassContainer">
	<div class="wrapper">
		<h1 class="title-medium"><%= UI_DISPLAY_LANG.views.pages.add_treatment_classes.sectionTitle %></h1>
	</div>
	<div class="mt-3 app-block">
		<div class="alert alert-info my-2" style="display:none;" id="ERROR_BOX">
			<img src="assets/img/utils/info.png" class="alert-icon" alt="">
			<div class="alert-text" id="text"></div>
		</div>
		<div class="" id="wrapper01">
			<form action="#" id="addForm">
				<div class="mb-2">
					<label for="" class="form-label"><%= UI_DISPLAY_LANG.views.pages.add_treatment_classes.form01.label02 %></label>
					<input type="text" class="input-text input-text-outline" id="classNameInput">
				</div>
				<div class="mb-2">
					<label for="" class="form-label"><%= UI_DISPLAY_LANG.views.pages.add_treatment_classes.form01.label03 %></label>
					<textarea class="input-text input-text-outline" rows="4" id="classDescInput"></textarea>
				</div>
				<div class="mb-2">
					<label for="" class="form-label"><%= UI_DISPLAY_LANG.views.pages.add_treatment_classes.form01.label01 %></label>
					<input type="number" step="any" class="input-text input-text-outline" id="classPriceInput">
				</div>
				<div class="">
					<input type="submit" class="btn btn-primary btn-sm" value="<%= UI_DISPLAY_LANG.views.pages.add_treatment_classes.form01.submitBTN01 %>">
				</div>
			</form>
		</div>
	</div>
</div>

<script>

$(function()
{

var addTreatmentClassContainer = $('#addTreatmentClassContainer');
if ( addTreatmentClassContainer[0] == undefined )
    return;

var ERROR_BOX = addTreatmentClassContainer.find('#ERROR_BOX');
var addForm = addTreatmentClassContainer.find('#addForm');
var classNameInput = addForm.find('#classNameInput');
var classDescInput = addForm.find('#classDescInput');
var classPriceInput = addForm.find('#classPriceInput');

var wrapper01 = addTreatmentClassContainer.find('#wrapper01');

var ClassObject = {
    classId: sessionData().classId,
    clinicId: null,
    className: null,
    classDesc: null
};
// clear session data
sessionData(true)
// submt
addForm.off('submit');
addForm.on('submit', e =>
{
    e.preventDefault();
    var target = addForm;
    ClassObject.className = classNameInput.val();
    ClassObject.classDesc = classDescInput.val();
    ClassObject.classPrice = classPriceInput.val();
    // display loader
    SectionLoader(wrapper01);
    // update
    if ( ClassObject.classId != null )
    {
        TREATMENT_CLASS_MODEL.update(ClassObject).then(response =>
        {
            // hide loader
            SectionLoader(wrapper01, '');
            if ( response.code == 404 )
            {
                ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                return;
            }
            ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
            // reset
            target[0].reset();
            ClassObject.classId = null;
        });

        return;
    }
    // add
    TREATMENT_CLASS_MODEL.store(ClassObject).then(response =>
    {
        // hide loader
        SectionLoader(wrapper01, '');
        if ( response.code == 404 )
        {
            ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
            return;
        }
        ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
        // reset
        target[0].reset();
    });
});
// display one
displayOne();
async function displayOne()
{
    if ( ClassObject.classId == null )
        return;

    // display loader
    SectionLoader(wrapper01);
    var response = await TREATMENT_CLASS_MODEL.show(ClassObject.classId);
    // hide loader
    SectionLoader(wrapper01, '');
    if ( response.code == 404 )
        return;

    var data = response.data;
    classNameInput.val(data.className);
    classDescInput.val(data.classDesc);
    classPriceInput.val(data.classPrice);
}

})

</script>