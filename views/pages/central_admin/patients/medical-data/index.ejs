<div class="container-fluid" id="View_patient_data_container">
	<div class="wrapper d-none">
		<h1 class="title-medium"><%= UI_DISPLAY_LANG.views.pages.all_patients.sectionTitle %></h1>
	</div>

    <!-- // To prevent script from appending back button to page -->
    <div class="my-2 d-none" style="position: absolute;top: 20px;right: 30px;z-index:5;">
		<button class="btn btn-success btn-sm shadow" id="page_back_button">
			<%= UI_DISPLAY_LANG.views.pages.global.back_button %>
		</button>
	</div>

	<div class="alert alert-info mt-3 mb-2" style="display:none;" id="ERROR_BOX">
		<img src="assets/img/utils/info.png" class="alert-icon" alt="">
		<div class="alert-text" id="text"></div>
	</div>

	<div class="mt-3 WRAPPER">
		
        <h4 class="display-6 mb-5">
			<span id="patient_name_heading"></span>
			<span>
				<a href="#" data-role="create_patient_medical_data" class="fw-400 fs-16 pointer"><%= UI_DISPLAY_LANG.views.pages.global.create_more_data %></a>
			</span>
		</h4>

		<div class="accordion accordion-01" id="patientSettingsAccordion">

			<div class="accordion-item">
				<h2 class="accordion-header" id="headingThree">
					<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
						
						<%= UI_DISPLAY_LANG.views.pages.all_patients.btn04 %>
					</button>
				</h2>
				<div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#patientSettingsAccordion">
					<div class="accordion-body">

                        <div class="row gx-4 gy-4">

                            <div class="col-lg-4 col-md-6">

                                <div class="images-carousel-trigger" data-target="#weight_images_carousel" data-for="weight">
                            
                                    <div class="mb-2">
                                        <a href="#" id="button"><%= UI_DISPLAY_LANG.views.pages.global.text1 %></a>
                                    </div>
        
                                    <div style="display:none;">
                                        <input type="text" id="total_pages" min="1" step="1" class="input-text input-text-outline">
                                    </div>
        
                                </div>

                                <div class="images-carousel-trigger-reports" data-target="#weight_images_carousel" data-for="weight">
                            
                                    <div class="mb-2">
                                        <a href="#" id="button"><%= UI_DISPLAY_LANG.views.pages.global.text63 %></a>
                                    </div>
        
                                    <!-- <div style="display:none;">
                                        <input type="text" id="total_pages" min="1" step="1" class="input-text input-text-outline">
                                    </div> -->
        
                                </div>

                            </div>

                            <div class="col-lg col-md">
                                <canvas id="weights_chart"></canvas>
                            </div>

                        </div>

						<div id="pagination3" class="my-3 flex flex-center"></div>
						<div class="utable shadowed" id="tableElement3">
							<div class="thead">
								<div class="td"><%= UI_DISPLAY_LANG.views.pages.all_patients.th04 %></div>
								<div class="td"><%= UI_DISPLAY_LANG.views.pages.all_patients.th02 %></div>
								<div class="td"></div>
								<div class="td"></div>
							</div>
							<div class="tbody">
								<!--
								<div class="tr">
									<div class="td">15</div>
									<div class="td">2022-06-24 | 03:54:43</div>
									<div class="td pointer">
										<button class="btn btn-danger btn-sm" data-role="DELETE" data-id="">
											<span class="no-pointer">
												<i class="fas fa-trash"></i>
											</span>
										</button>
									</div>
								</div>
								-->
							</div>
						</div>
					</div>
				</div>
			</div>

            <div class="accordion-item">
				<h2 class="accordion-header" id="heading15">
					<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse15" aria-expanded="false" aria-controls="collapse15">
						
						<%= UI_DISPLAY_LANG.views.pages.all_patients.btn17 %>
					</button>
				</h2>
				<div id="collapse15" class="accordion-collapse collapse" aria-labelledby="heading15" data-bs-parent="#patientSettingsAccordion">
					<div class="accordion-body">
						<div id="medicalTestsImagesCarousel" class="carousel slide" data-bs-ride="carousel">
							<div class="carousel-inner">
							  <!-- <div class="carousel-item active" data-bs-interval="10000">
								<img src="..." class="d-block w-100" alt="...">
							  </div>
							  <div class="carousel-item" data-bs-interval="2000">
								<div class="row gx-0 gy-0">
									<div class="col">
										<img src="..." class="d-block w-100" alt="...">
									</div>
								</div>
							  </div>
							  <div class="carousel-item">
								<img src="..." class="d-block w-100" alt="...">
							  </div> -->
							</div>
							<button class="carousel-control-prev" type="button" data-bs-target="#medicalTestsImagesCarousel" data-bs-slide="prev">
							  <span class="carousel-control-prev-icon" aria-hidden="true"></span>
							  <span class="visually-hidden">Previous</span>
							</button>
							<button class="carousel-control-next" type="button" data-bs-target="#medicalTestsImagesCarousel" data-bs-slide="next">
							  <span class="carousel-control-next-icon" aria-hidden="true"></span>
							  <span class="visually-hidden">Next</span>
							</button>
						</div>
					</div>
				</div>
			</div>

            <div class="accordion-item" data-perm="view_patient_reports">
				<h2 class="accordion-header" id="heading18">
					<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse18" aria-expanded="false" aria-controls="collapse18">
						
						<%= UI_DISPLAY_LANG.views.pages.all_patients.btn21 %>
					</button>
				</h2>
				<div id="collapse18" class="accordion-collapse collapse" aria-labelledby="heading18" data-bs-parent="#patientSettingsAccordion">
					<div class="accordion-body">
						
                        <div class="table-nav">
			
                            <div class="row mb-4">
                
                                <div class="col-lg-12 col-md-12">
                                    <button class="btn btn-danger btn-sm" id="view_patient_reports__deleteSelectedBTN" data-perm="delete_patient_reports">
                                        <%= UI_DISPLAY_LANG.views.pages.global.delete_selected_button %>
                                    </button>
                                </div>
                
                                <div class="col-lg-3 col-md-6 col-sm-12">
                                    <%- include(`${SETTINGS.UI_Settings.MAIN_DIR_NAME}/views/templates/searchbox.template.ejs`, {
                                        searchBtnId: 'view_patient_reports__search_btn',
                                        searchInputId: 'view_patient_reports__search_input',
                                    }) -%>
                                </div>
                                <div class="col-lg-3 col-md-6 col-sm-12">
                                    <%- include(`${SETTINGS.UI_Settings.MAIN_DIR_NAME}/views/templates/start-end-date.template.ejs`, {
                                        dateStartId: 'view_patient_reports__date_start_input',
                                        dateEndId: 'view_patient_reports__date_end_input',
                                    }) -%>
                                </div>
                
                            </div>
                
                        </div>
                
                        <div id="view_patient_reports__pagination" class="my-3 flex flex-center"></div>
                        <div class="utable shadowed" id="view_patient_reports__tableElement">
                            <div class="thead">
                                <div class="td">#</div>
                                <div class="td"><%= UI_DISPLAY_LANG.views.pages.global.th4 %></div>
                                <div class="td"></div>
                            </div>
                            <div class="tbody">
                                <!--
                                <div class="tr">
                                    <div class="td">
                                        <input type="checkbox" class="form-check-input pointer" data-role="CHECK" data-classid="">
                                    </div>
                                    <div class="td">clinicname</div>
                                    <div class="td">classname</div>
                                    <div class="td">classdesc</div>
                                    <div class="td">date</div>
                                    <div class="td">
                                        <button class="btn btn-primary btn-sm pointer" data-role="UPDATE" data-aptid="">
                                            <span class="no-pointer"><i class="fas fa-edit"></i></span>
                                        </button>		
                                    </div>
                                </div>
                                -->
                            </div>
                        </div>

					</div>
				</div>
			</div>

            <div class="accordion-item" data-perm="view_patient_partial_body_analisys">
				<h2 class="accordion-header" id="heading17">
					<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse17" aria-expanded="false" aria-controls="collapse17">
						
						<%= UI_DISPLAY_LANG.views.pages.all_patients.btn20 %>
					</button>
				</h2>
				<div id="collapse17" class="accordion-collapse collapse" aria-labelledby="heading17" data-bs-parent="#patientSettingsAccordion">
					<div class="accordion-body">
						<div id="view_patient_partial_body_analisys_carousel" class="carousel slide" data-bs-ride="carousel">
							<div class="carousel-inner">
							  <!-- <div class="carousel-item active" data-bs-interval="10000">
								<img src="..." class="d-block w-100" alt="...">
							  </div>
							  <div class="carousel-item" data-bs-interval="2000">
								<div class="row gx-0 gy-0">
									<div class="col">
										<img src="..." class="d-block w-100" alt="...">
									</div>
								</div>
							  </div>
							  <div class="carousel-item">
								<img src="..." class="d-block w-100" alt="...">
							  </div> -->
							</div>
							<button class="carousel-control-prev" type="button" data-bs-target="#view_patient_partial_body_analisys_carousel" data-bs-slide="prev">
							  <span class="carousel-control-prev-icon" aria-hidden="true"></span>
							  <span class="visually-hidden">Previous</span>
							</button>
							<button class="carousel-control-next" type="button" data-bs-target="#view_patient_partial_body_analisys_carousel" data-bs-slide="next">
							  <span class="carousel-control-next-icon" aria-hidden="true"></span>
							  <span class="visually-hidden">Next</span>
							</button>
						</div>
					</div>
				</div>
			</div>
            
            <h4 class="h4 my-4"><%= UI_DISPLAY_LANG.views.pages.global.text66 %></h4>

            <div class="accordion-item">
				<h2 class="accordion-header" id="headingOne">
					<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
						<%= UI_DISPLAY_LANG.views.pages.all_patients.btn02 %>
					</button>
				</h2>
				<div id="collapseOne" class="accordion-collapse collapse" aria-labelledby="headingOne" data-bs-parent="#patientSettingsAccordion">
					<div class="accordion-body">
						<div id="pagination0" class="my-3 flex flex-center"></div>
						<div class="utable shadowed" id="tableElement0">
							<div class="thead">
								<div class="td"><%= UI_DISPLAY_LANG.views.pages.all_patients.th01 %></div>
								<div class="td"><%= UI_DISPLAY_LANG.views.pages.all_patients.th02 %></div>
								<div class="td"></div>
								<div class="td"></div>
							</div>
							<div class="tbody">
								<!--
								<div class="tr">
									<div class="td">15</div>
									<div class="td">2022-06-24 | 03:54:43</div>
									<div class="td pointer">
										<button class="btn btn-danger btn-sm" data-role="DELETE" data-id="">
											<span class="no-pointer">
												<i class="fas fa-trash"></i>
											</span>
										</button>
									</div>
								</div>
								-->
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="accordion-item">
				<h2 class="accordion-header" id="headingEight">
					<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseEight" aria-expanded="false" aria-controls="collapseEight">
						
						<%= UI_DISPLAY_LANG.views.pages.all_patients.btn09 %>
					</button>
				</h2>
				<div id="collapseEight" class="accordion-collapse collapse" aria-labelledby="headingEight" data-bs-parent="#patientSettingsAccordion">
					<div class="accordion-body">
						<div id="pagination5" class="my-3 flex flex-center"></div>
						<div class="utable shadowed" id="tableElement5">
							<div class="thead">
								<div class="td"><%= UI_DISPLAY_LANG.views.pages.all_patients.th06 %></div>
								<div class="td"><%= UI_DISPLAY_LANG.views.pages.all_patients.th02 %></div>
								<div class="td"></div>
								<div class="td"></div>
							</div>
							<div class="tbody">
								<!--
								<div class="tr">
									<div class="td">15</div>
									<div class="td">2022-06-24 | 03:54:43</div>
									<div class="td pointer">
										<button class="btn btn-danger btn-sm" data-role="DELETE" data-id="">
											<span class="no-pointer">
												<i class="fas fa-trash"></i>
											</span>
										</button>
									</div>
								</div>
								-->
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="accordion-item">
				<h2 class="accordion-header" id="heading11">
					<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse11" aria-expanded="false" aria-controls="collapse11">
						
						<%= UI_DISPLAY_LANG.views.pages.all_patients.btn12 %>
					</button>
				</h2>
				<div id="collapse11" class="accordion-collapse collapse" aria-labelledby="heading11" data-bs-parent="#patientSettingsAccordion">
					<div class="accordion-body">
						<div id="pagination8" class="my-3 flex flex-center"></div>
						<div class="utable shadowed" id="tableElement8">
							<div class="thead">
								<div class="td"><%= UI_DISPLAY_LANG.views.pages.all_patients.th06 %></div>
								<div class="td"><%= UI_DISPLAY_LANG.views.pages.all_patients.th02 %></div>
								<div class="td"></div>
								<div class="td"></div>
							</div>
							<div class="tbody">
								<!--
								<div class="tr">
									<div class="td">15</div>
									<div class="td">2022-06-24 | 03:54:43</div>
									<div class="td pointer">
										<button class="btn btn-danger btn-sm" data-role="DELETE" data-id="">
											<span class="no-pointer">
												<i class="fas fa-trash"></i>
											</span>
										</button>
									</div>
								</div>
								-->
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="accordion-item">
				<h2 class="accordion-header" id="heading12">
					<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse12" aria-expanded="false" aria-controls="collapse12">
						
						<%= UI_DISPLAY_LANG.views.pages.all_patients.btn13 %>
					</button>
				</h2>
				<div id="collapse12" class="accordion-collapse collapse" aria-labelledby="heading12" data-bs-parent="#patientSettingsAccordion">
					<div class="accordion-body">
						<div id="pagination9" class="my-3 flex flex-center"></div>
						<div class="utable shadowed" id="tableElement9">
							<div class="thead">
								<div class="td"><%= UI_DISPLAY_LANG.views.pages.all_patients.th06 %></div>
								<div class="td"><%= UI_DISPLAY_LANG.views.pages.all_patients.th02 %></div>
								<div class="td"></div>
								<div class="td"></div>
							</div>
							<div class="tbody">
								<!--
								<div class="tr">
									<div class="td">15</div>
									<div class="td">2022-06-24 | 03:54:43</div>
									<div class="td pointer">
										<button class="btn btn-danger btn-sm" data-role="DELETE" data-id="">
											<span class="no-pointer">
												<i class="fas fa-trash"></i>
											</span>
										</button>
									</div>
								</div>
								-->
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="accordion-item">
				<h2 class="accordion-header" id="heading13">
					<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse13" aria-expanded="false" aria-controls="collapse13">
						
						<%= UI_DISPLAY_LANG.views.pages.all_patients.btn14 %>
					</button>
				</h2>
				<div id="collapse13" class="accordion-collapse collapse" aria-labelledby="heading13" data-bs-parent="#patientSettingsAccordion">
					<div class="accordion-body">
						<div id="pagination10" class="my-3 flex flex-center"></div>
						<div class="utable shadowed" id="tableElement10">
							<div class="thead">
								<div class="td"><%= UI_DISPLAY_LANG.views.pages.all_patients.th06 %></div>
								<div class="td"><%= UI_DISPLAY_LANG.views.pages.all_patients.th02 %></div>
								<div class="td"></div>
								<div class="td"></div>
							</div>
							<div class="tbody">
								<!--
								<div class="tr">
									<div class="td">15</div>
									<div class="td">2022-06-24 | 03:54:43</div>
									<div class="td pointer">
										<button class="btn btn-danger btn-sm" data-role="DELETE" data-id="">
											<span class="no-pointer">
												<i class="fas fa-trash"></i>
											</span>
										</button>
									</div>
								</div>
								-->
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="accordion-item">
				<h2 class="accordion-header" id="heading14">
					<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse14" aria-expanded="false" aria-controls="collapse14">
						
						<%= UI_DISPLAY_LANG.views.pages.all_patients.btn15 %>
					</button>
				</h2>
				<div id="collapse14" class="accordion-collapse collapse" aria-labelledby="heading14" data-bs-parent="#patientSettingsAccordion">
					<div class="accordion-body">
						<div id="pagination11" class="my-3 flex flex-center"></div>
						<div class="utable shadowed" id="tableElement11">
							<div class="thead">
								<div class="td"><%= UI_DISPLAY_LANG.views.pages.all_patients.th06 %></div>
								<div class="td"><%= UI_DISPLAY_LANG.views.pages.all_patients.th02 %></div>
								<div class="td"></div>
								<div class="td"></div>
							</div>
							<div class="tbody">
								<!--
								<div class="tr">
									<div class="td">15</div>
									<div class="td">2022-06-24 | 03:54:43</div>
									<div class="td pointer">
										<button class="btn btn-danger btn-sm" data-role="DELETE" data-id="">
											<span class="no-pointer">
												<i class="fas fa-trash"></i>
											</span>
										</button>
									</div>
								</div>
								-->
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="accordion-item">
				<h2 class="accordion-header" id="headingTwo">
					<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
						<%= UI_DISPLAY_LANG.views.pages.all_patients.btn03 %>
					</button>
				</h2>
				<div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#patientSettingsAccordion">
					<div class="accordion-body">
						<div id="pagination2" class="my-3 flex flex-center"></div>
						<div class="utable shadowed" id="tableElement2">
							<div class="thead">
								<div class="td"><%= UI_DISPLAY_LANG.views.pages.all_patients.th03 %></div>
								<div class="td"><%= UI_DISPLAY_LANG.views.pages.all_patients.th02 %></div>
								<div class="td"></div>
								<div class="td"></div>
							</div>
							<div class="tbody">
								<!--
								<div class="tr">
									<div class="td">15</div>
									<div class="td">2022-06-24 | 03:54:43</div>
									<div class="td pointer">
										<button class="btn btn-danger btn-sm" data-role="DELETE" data-id="">
											<span class="no-pointer">
												<i class="fas fa-trash"></i>
											</span>
										</button>
									</div>
								</div>
								-->
							</div>
						</div>
					</div>
				</div>
			</div>

            <div class="accordion-item">
				<h2 class="accordion-header" id="heading16">
					<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse16" aria-expanded="false" aria-controls="collapse16">
						
						<%= UI_DISPLAY_LANG.views.pages.all_patients.btn19 %>
					</button>
				</h2>
				<div id="collapse16" class="accordion-collapse collapse" aria-labelledby="heading16" data-bs-parent="#patientSettingsAccordion">
					<div class="accordion-body">
						<div id="albumsCarousel" class="carousel slide" data-bs-ride="carousel">
							<div class="carousel-inner">
							  <!-- <div class="carousel-item active" data-bs-interval="10000">
								<img src="..." class="d-block w-100" alt="...">
							  </div>
							  <div class="carousel-item" data-bs-interval="2000">
								<div class="row gx-0 gy-0">
									<div class="col">
										<img src="..." class="d-block w-100" alt="...">
									</div>
								</div>
							  </div>
							  <div class="carousel-item">
								<img src="..." class="d-block w-100" alt="...">
							  </div> -->
							</div>
							<button class="carousel-control-prev" type="button" data-bs-target="#albumsCarousel" data-bs-slide="prev">
							  <span class="carousel-control-prev-icon" aria-hidden="true"></span>
							  <span class="visually-hidden">Previous</span>
							</button>
							<button class="carousel-control-next" type="button" data-bs-target="#albumsCarousel" data-bs-slide="next">
							  <span class="carousel-control-next-icon" aria-hidden="true"></span>
							  <span class="visually-hidden">Next</span>
							</button>
						</div>
					</div>
				</div>
			</div>

			<div class="accordion-item d-none">
				<h2 class="accordion-header" id="headingFour">
					<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
						
						<%= UI_DISPLAY_LANG.views.pages.all_patients.btn05 %>
					</button>
				</h2>
				<div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour" data-bs-parent="#patientSettingsAccordion">
					<div class="accordion-body">
						<div id="pagination4" class="my-3 flex flex-center"></div>
						<div class="utable shadowed" id="tableElement4">
							<div class="thead">
								<div class="td"><%= UI_DISPLAY_LANG.views.pages.all_patients.th05 %></div>
								<div class="td"><%= UI_DISPLAY_LANG.views.pages.all_patients.th02 %></div>
								<div class="td"></div>
								<div class="td"></div>
							</div>
							<div class="tbody">
								<!--
								<div class="tr">
									<div class="td">15</div>
									<div class="td">2022-06-24 | 03:54:43</div>
									<div class="td pointer">
										<button class="btn btn-danger btn-sm" data-role="DELETE" data-id="">
											<span class="no-pointer">
												<i class="fas fa-trash"></i>
											</span>
										</button>
									</div>
								</div>
								-->
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="accordion-item d-none">
				<h2 class="accordion-header" id="headingNine">
					<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseNine" aria-expanded="false" aria-controls="collapseNine">
						
						<%= UI_DISPLAY_LANG.views.pages.all_patients.btn10 %>
					</button>
				</h2>
				<div id="collapseNine" class="accordion-collapse collapse" aria-labelledby="headingNine" data-bs-parent="#patientSettingsAccordion">
					<div class="accordion-body">
						<div id="pagination6" class="my-3 flex flex-center"></div>
						<div class="utable shadowed" id="tableElement6">
							<div class="thead">
								<div class="td"><%= UI_DISPLAY_LANG.views.pages.all_patients.th05 %></div>
								<div class="td"><%= UI_DISPLAY_LANG.views.pages.all_patients.th02 %></div>
								<div class="td"></div>
								<div class="td"></div>
							</div>
							<div class="tbody">
								<!--
								<div class="tr">
									<div class="td">15</div>
									<div class="td">2022-06-24 | 03:54:43</div>
									<div class="td pointer">
										<button class="btn btn-danger btn-sm" data-role="DELETE" data-id="">
											<span class="no-pointer">
												<i class="fas fa-trash"></i>
											</span>
										</button>
									</div>
								</div>
								-->
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="accordion-item d-none">
				<h2 class="accordion-header" id="headingTen">
					<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTen" aria-expanded="false" aria-controls="collapseTen">
						
						<%= UI_DISPLAY_LANG.views.pages.all_patients.btn11 %>
					</button>
				</h2>
				<div id="collapseTen" class="accordion-collapse collapse" aria-labelledby="headingTen" data-bs-parent="#patientSettingsAccordion">
					<div class="accordion-body">
						<div id="pagination7" class="my-3 flex flex-center"></div>
						<div class="utable shadowed" id="tableElement7">
							<div class="thead">
								<div class="td"><%= UI_DISPLAY_LANG.views.pages.all_patients.th05 %></div>
								<div class="td"><%= UI_DISPLAY_LANG.views.pages.all_patients.th02 %></div>
								<div class="td"></div>
								<div class="td"></div>
							</div>
							<div class="tbody">
								<!--
								<div class="tr">
									<div class="td">15</div>
									<div class="td">2022-06-24 | 03:54:43</div>
									<div class="td pointer">
										<button class="btn btn-danger btn-sm" data-role="DELETE" data-id="">
											<span class="no-pointer">
												<i class="fas fa-trash"></i>
											</span>
										</button>
									</div>
								</div>
								-->
							</div>
						</div>
					</div>
				</div>
			</div>

			

		</div>

	</div>

</div>

<script>

$(function()
{
	
var page_container = $('#View_patient_data_container')
if ( !page_container[0] ) return

var ERROR_BOX = page_container.find('#ERROR_BOX');
var patient_name_heading = page_container.find('#patient_name_heading')
var create_patient_medical_data = page_container.find('[data-role="create_patient_medical_data"]')

var PatientObject = sessionData(true)

// display name
patient_name_heading.text(PatientObject.patientName)
// create_patient_medical_data
create_patient_medical_data.on('click', e =>
{
	e.preventDefault()

	goToPage('create-patient-medical-data', PatientObject)
})
//
// init carousel triggers
const DEFAULT_CAROUSEL_TOTAL_PAGES = 7
// reports
$('.images-carousel-trigger').each((k,v) =>
{
    var trigger = $(v)
    var trigger_button = trigger.find('#button')
    var total_pages_input = trigger.find('#total_pages')
    var _for = trigger.data('for') 

    trigger_button.off('mouseenter').on('mouseenter', e =>
    {
        e.preventDefault()

        total_pages_input.parent().slideDown(200)
    })

    trigger.off('mouseleave').on('mouseleave', e =>
    {
        total_pages_input.parent().slideUp(200)
    })

    trigger_button.off('click').on('click', async e =>
    {

        var res = await PATIENT_MODEL.changedSettings({
            patientId: PatientObject.patientId,
            column: _for,
            type: "report",
        })
        
        if (res.code == 404) return

        var data = res.data
        var printable_page_html_list = []
        var total_pages = (total_pages_input.val() == '') ? DEFAULT_CAROUSEL_TOTAL_PAGES : total_pages_input.val()

        var images = []
        // extract images
        $.each(data, (k,v) =>
        {
            var url = null

            if ( !v.doc ) return

            images.push({
                url: v.doc.url,
                timestamp: v.infoDate +' '+ v.infoTime
            })
        })
        // create printable page with the extracted images
        var html = ''
        console.log(PatientObject)
        var printable_page = createFakeElement('FAKE_CONTAINER', await (getPage('../views/prints/weight-images-report-page.ejs')) ).find('.weights-images-report-print')

        var pcount = 1
        for (let i = 0; i < images.length; i++) 
        {
            const image = images[i];

            html += `<li>
                        <div class="mb-2 fw-600">${image.timestamp}</div>
                        <div class="">
                            <img src="${image.url}" class="pointer cursor-pointer" data-role="weight_image" alt="">
                        </div>
                    </li>`
            if ( pcount == total_pages || i == images.length-1 )
            {
                printable_page.css('margin', '0 auto')
                printable_page.find('#weight_images_list').html(html)
                printable_page.find('#header_code').html(PatientObject.patientCode)
                printable_page.find('#header_bb').html(PatientObject.patientName)
                printable_page.find('#header_date').html(CURRENT_DATE)
                printable_page_html_list.push( printable_page[0].outerHTML )
                html = ''
                pcount = 0
            }

            pcount++
        }

        // append pages to carousel and display
        var html = ''
        for (let i = 0; i < printable_page_html_list.length; i++) 
        {
            const page_html = printable_page_html_list[i];
            if ( i == 0 )
            {
                html += `<div class="carousel-item active">

                            <div class="mt-5 has-text-centered">
                                <a href="#" class="print-button">${FUI_DISPLAY_LANG.views.pages.global.text2}</a>    
                            </div>
                            
                            ${page_html} 
      
                        </div>`
            }
            else
            {
                html += `<div class="carousel-item">

                            <div class="mt-5 has-text-centered">
                                <a href="#" class="print-button">${FUI_DISPLAY_LANG.views.pages.global.text2}</a>    
                            </div>
                            
                            ${page_html} 
      
                        </div>`
            }
        }

        var carousel_html = `<div id="weight_images_carousel" class="carousel slide" data-bs-ride="carousel">
                                <div class="carousel-inner">
                                    ${html}
                                </div>
                                <button class="carousel-control-prev" type="button" data-bs-target="#weight_images_carousel" data-bs-slide="prev">
                                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                    <span class="visually-hidden">Previous</span>
                                </button>
                                <button class="carousel-control-next" type="button" data-bs-target="#weight_images_carousel" data-bs-slide="next">
                                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                    <span class="visually-hidden">Next</span>
                                </button>
                            </div>`

        FullpageDialog({
            container: 'weight_carousel_dialog',
            html: carousel_html
        })
        // 
        var weight_images_carousel = $('#weight_images_carousel')
        // print on button click
        weight_images_carousel.find('.print-button').each((k,v) =>
        {
            var print_button = $(v)

            print_button.off('click').on('click', e =>
            {
                e.preventDefault()
                var carousel_item = print_button.closest('.carousel-item')
                var printable_page = carousel_item.find('.weights-images-report-print')
                printable_page.removeClass('is-preview')
                var html = printable_page[0].outerHTML
                printHTMLToPdf(html, {
                    top: 10000,
                    left: 10000,
                    page: {
                        size: `A4 landscape`,
                        margin: '-1cm -1cm -1cm -1cm' 
                    }
                })
                printable_page.addClass('is-preview')
            })
            
        })
        // interract with images
        weight_images_carousel.off('click').on('click', e =>
        {
            var target = $(e.target)
            if ( target.data('role') == 'weight_image' )
            {
                var currentImage = target.attr('src')
                var images = $.map( weight_images_carousel.find('[data-role="weight_image"]'), (element, k)  => {
                    const img = $(element)
                    return img.attr('src')
                })
                // add current image to start of array
                images.unshift(currentImage)
                
                CreateImageSliderDialog({
                    images
                })
            }
        })
    })

    total_pages_input.off('keydown').on('keydown', e =>
    {
        if ( e.key == "Enter" )
        {
            trigger_button.trigger('click')
        }
    })
})
// general
$('.images-carousel-trigger-reports').each((k,v) =>
{
    var trigger = $(v)
    var trigger_button = trigger.find('#button')
    var total_pages_input = trigger.find('#total_pages')
    var _for = trigger.data('for') 

    trigger_button.off('mouseenter').on('mouseenter', e =>
    {
        e.preventDefault()

        total_pages_input.parent().slideDown(200)
    })

    trigger.off('mouseleave').on('mouseleave', e =>
    {
        total_pages_input.parent().slideUp(200)
    })

    trigger_button.off('click').on('click', async e =>
    {

        var res = await PATIENT_MODEL.changedSettings({
            patientId: PatientObject.patientId,
            column: _for,
            type: "general",
        })
        
        if (res.code == 404) return

        var data = res.data
        var printable_page_html_list = []
        var total_pages = (total_pages_input.val() == '') ? DEFAULT_CAROUSEL_TOTAL_PAGES : total_pages_input.val()

        var images = []
        // extract images
        $.each(data, (k,v) =>
        {
            var url = null

            if ( !v.doc ) return

            images.push({
                url: v.doc.url,
                timestamp: v.infoDate +' '+ v.infoTime
            })
        })
        // create printable page with the extracted images
        var html = ''
        console.log(PatientObject)
        var printable_page = createFakeElement('FAKE_CONTAINER', await (getPage('../views/prints/weight-images-report-page.ejs')) ).find('.weights-images-report-print')

        var pcount = 1
        for (let i = 0; i < images.length; i++) 
        {
            const image = images[i];
            var height = printable_page.height()

            html += `<li style="width: 100%;height:${height-180}px;">
                        <div class="mb-2 fw-600">${image.timestamp}</div>
                        <div class="position-relative w-100 h-100">
                            <img src="${image.url}" class="pointer cursor-pointer position-absolute w-100 h-100 js_img_previewable" data-role="weight_image" alt="" style="height: ${height-180}px;max-height:unset;top:0;left:0;">
                        </div>
                    </li>`
            // if ( pcount == total_pages || i == images.length-1 )
            // {
            printable_page.css('margin', '0 auto')
            printable_page.find('#weight_images_list').html(html)
            printable_page.find('#header_code').html(PatientObject.patientCode)
            printable_page.find('#header_bb').html(PatientObject.patientName)
            printable_page.find('#header_date').html(CURRENT_DATE)
            printable_page_html_list.push( printable_page[0].outerHTML )
            html = ''
            pcount = 0
            // }

            pcount++
        }

        // append pages to carousel and display
        var html = ''
        for (let i = 0; i < printable_page_html_list.length; i++) 
        {
            const page_html = printable_page_html_list[i];
            if ( i == 0 )
            {
                html += `<div class="carousel-item active">

                            <div class="mt-5 has-text-centered">
                                <a href="#" class="print-button">${FUI_DISPLAY_LANG.views.pages.global.text2}</a>    
                            </div>
                            
                            ${page_html} 
      
                        </div>`
            }
            else
            {
                html += `<div class="carousel-item">

                            <div class="mt-5 has-text-centered">
                                <a href="#" class="print-button">${FUI_DISPLAY_LANG.views.pages.global.text2}</a>    
                            </div>
                            
                            ${page_html} 
      
                        </div>`
            }
        }

        var carousel_html = `<div id="weight_images_carousel" class="carousel slide" data-bs-ride="carousel">
                                <div class="carousel-inner">
                                    ${html}
                                </div>
                                <button class="carousel-control-prev" type="button" data-bs-target="#weight_images_carousel" data-bs-slide="prev">
                                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                    <span class="visually-hidden">Previous</span>
                                </button>
                                <button class="carousel-control-next" type="button" data-bs-target="#weight_images_carousel" data-bs-slide="next">
                                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                    <span class="visually-hidden">Next</span>
                                </button>
                            </div>`

        FullpageDialog({
            container: 'weight_carousel_dialog',
            html: carousel_html
        })
        // dispatch_onNewAjaxContentLoaded
        dispatch_onNewAjaxContentLoaded()
        // 
        var weight_images_carousel = $('#weight_images_carousel')
        // print on button click
        weight_images_carousel.find('.print-button').each((k,v) =>
        {
            var print_button = $(v)

            print_button.off('click').on('click', e =>
            {
                e.preventDefault()
                var carousel_item = print_button.closest('.carousel-item')
                var printable_page = carousel_item.find('.weights-images-report-print')
                printable_page.removeClass('is-preview')
                var html = printable_page[0].outerHTML
                printHTMLToPdf(html, {
                    top: 10000,
                    left: 10000,
                    page: {
                        size: `A4 landscape`,
                        margin: '-1cm -1cm -1cm -1cm' 
                    }
                })
                printable_page.addClass('is-preview')
            })
            
        })
        // interract with images
        // weight_images_carousel.off('click').on('click', e =>
        // {
        //     var target = $(e.target)
        //     if ( target.data('role') == 'weight_image' )
        //     {
        //         var currentImage = target.attr('src')
        //         var images = $.map( weight_images_carousel.find('[data-role="weight_image"]'), (element, k)  => {
        //             const img = $(element)
        //             return img.attr('src')
        //         })
        //         // add current image to start of array
        //         images.unshift(currentImage)
                
        //         CreateImageSliderDialog({
        //             images
        //         })
        //     }
        // })
    })

    total_pages_input.off('keydown').on('keydown', e =>
    {
        if ( e.key == "Enter" )
        {
            trigger_button.trigger('click')
        }
    })
})

// update additional settings
updateAdditionalSettings()
function updateAdditionalSettings()
{
    // blood pressure
    var collapseOne = page_container.find('#collapseOne');
    var pagination0 = collapseOne.find('#pagination0');
    var tableElement0 = collapseOne.find('#tableElement0');

    if ( PatientObject.hasBloodPressure == ST_NO )
        tableElement0.closest('.accordion-item').addClass('disabled');

    // tableElement click
    tableElement0.off('click');
    tableElement0.on('click', e =>
    {
        var target = $(e.target);
        if ( target.data('role') == 'DELETE' )
        {
            PromptConfirmDialog().then(c =>
            {
                // display loader
                SectionLoader(collapseOne.find('.accordion-body'));
                PATIENT_MODEL.deleteChangedSetting({
                    id: target.data('id'),
                    column: 'blood_pressure'
                }).then(response =>
                {
                    // hide loader
                    SectionLoader(collapseOne.find('.accordion-body'), '');
                    if ( response.code == 404 )	
                    {
                        ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                        return;
                    }
                    ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                    // 
                    displayBloodPressure();
                });
            });
        }
        else if ( target.data('role') == 'PREVIEW_DOC' )
        {
            e.preventDefault();
            PreviewFileDialog({
                url: target.attr('href')
            });
        }
    });
    // collapseOne
    collapseOne.off('shown.bs.collapse');
    collapseOne.on('shown.bs.collapse', e =>
    {
        displayBloodPressure();
    });
    //collapseOne.trigger('shown.bs.collapse');

    // display blood pressure
    function displayBloodPressure()
    {
        // display blood pressure
        SectionLoader(collapseOne.find('.accordion-body'));
        // clear html
        tableElement0.find('.tbody').html('');

        PATIENT_MODEL.changedSettings({
            patientId: PatientObject.patientId,
            column: 'blood_pressure'
        }).then(response =>
        {
            // hide loader
            SectionLoader(collapseOne.find('.accordion-body'), '');
            
            if ( response.code == 404 )
                return;

            var data = response.data;
            var html = '';
            $.each(data, (k,v) =>
            {
                var doc_url = docURL(v);
                var patient_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="DOWNLOAD_FILE" download="${path.basename(doc_url)}">تحميل الملف</a>` : '';
                var preview_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="PREVIEW_DOC">فتح الملف للمعاينة</a>` : '';
                var print_doc_link = ''

                if ( doc_url != '' )
                {
                    print_doc_link = ( isImageFile(doc_url) != '') ? `<a href="${doc_url}" data-role="PRINT_DOC" class="js_trigger_print_source_url_dialog">${FUI_DISPLAY_LANG.views.pages.global.print_}</a>` : '';
                }
                if ( FUI_DISPLAY_LANG.lang == 'fr' )
                {
                    patient_doc_link = (doc_url) ? `<a href="${doc_url}" data-role="DOWNLOAD_FILE" download="${path.basename(doc_url)}">télécharger un fichier</a>` : '';
                    preview_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="PREVIEW_DOC">Ouvrir le fichier pour l'aperçu</a>` : '';
                }
                html += `<div class="tr">
                            <div class="td">${v.blood_pressure}</div>
                            <div class="td">${v.infoDate}|${v.infoTime}</div>
                            <div class="td pointer">
                                ${patient_doc_link}
                                <div>
                                    ${preview_doc_link}
                                </div>
                                <div>
                                    ${print_doc_link}    
                                </div>
                            </div>
                            <div class="td pointer">
                                <button class="btn btn-danger btn-sm" data-role="DELETE" data-id="${v.id}">
                                    <span class="no-pointer">
                                        <i class="fas fa-trash"></i>
                                    </span>
                                </button>
                            </div>
                        </div>PAG_SEP`;
            });
            // add html
            var options = {
                data: html.split('PAG_SEP')
            };
            new SmoothPagination(pagination0, tableElement0.find('.tbody'), options);
        });
    }
    // diabetes
    var collapseTwo = page_container.find('#collapseTwo');
    var pagination2 = collapseTwo.find('#pagination2');
    var tableElement2 = collapseTwo.find('#tableElement2');

    if ( PatientObject.hasDiabetes == ST_NO )
        tableElement2.closest('.accordion-item').addClass('disabled');

    // tableElement click
    tableElement2.off('click');
    tableElement2.on('click', e =>
    {
        var target = $(e.target);
        if ( target.data('role') == 'DELETE' )
        {
            PromptConfirmDialog().then(c =>
            {
                // display loader
                SectionLoader(collapseTwo.find('.accordion-body'));
                PATIENT_MODEL.deleteChangedSetting({
                    id: target.data('id'),
                    column: 'diabetes'
                }).then(response =>
                {
                    // hide loader
                    SectionLoader(collapseTwo.find('.accordion-body'), '');
                    if ( response.code == 404 )	
                    {
                        ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                        return;
                    }
                    ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                    // 
                    displayDiabetes();
                });
            });
        }
        else if ( target.data('role') == 'PREVIEW_DOC' )
        {
            e.preventDefault();
            PreviewFileDialog({
                url: target.attr('href')
            });
        }
    });
    // collapseTwo
    collapseTwo.off('shown.bs.collapse');
    collapseTwo.on('shown.bs.collapse', e =>
    {
        displayDiabetes();
    });

    // display diabetes
    function displayDiabetes()
    {
        // display blood pressure
        SectionLoader(collapseTwo.find('.accordion-body'));
        // clear html
        tableElement2.find('.tbody').html('');

        PATIENT_MODEL.changedSettings({
            patientId: PatientObject.patientId,
            column: 'diabetes'
        }).then(response =>
        {
            // hide loader
            SectionLoader(collapseTwo.find('.accordion-body'), '');
            
            if ( response.code == 404 )
                return;

            var data = response.data;
            var html = '';
            $.each(data, (k,v) =>
            {

                var doc_url = docURL(v);
                var patient_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="DOWNLOAD_FILE" download="${path.basename(doc_url)}">تحميل الملف</a>` : '';
                var preview_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="PREVIEW_DOC">فتح الملف للمعاينة</a>` : '';
                var print_doc_link = ''

                if ( doc_url != '' )
                {
                    print_doc_link = ( isImageFile(doc_url) != '') ? `<a href="${doc_url}" data-role="PRINT_DOC" class="js_trigger_print_source_url_dialog">${FUI_DISPLAY_LANG.views.pages.global.print_}</a>` : '';
                }
                if ( FUI_DISPLAY_LANG.lang == 'fr' )
                {
                    patient_doc_link = (doc_url) ? `<a href="${doc_url}" data-role="DOWNLOAD_FILE" download="${path.basename(doc_url)}">télécharger un fichier</a>` : '';
                    preview_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="PREVIEW_DOC">Ouvrir le fichier pour l'aperçu</a>` : '';
                }
                html += `<div class="tr">
                            <div class="td">${v.diabetes}</div>
                            <div class="td">${v.infoDate}|${v.infoTime}</div>
                            <div class="td pointer">
                                ${patient_doc_link}
                                <div>
                                    ${preview_doc_link}
                                </div>
                                <div>
                                    ${print_doc_link}    
                                </div>
                            </div>
                            <div class="td pointer">
                                <button class="btn btn-danger btn-sm" data-role="DELETE" data-id="${v.id}">
                                    <span class="no-pointer">
                                        <i class="fas fa-trash"></i>
                                    </span>
                                </button>
                            </div>
                        </div>PAG_SEP`;
            });
            // add html
            var options = {
                data: html.split('PAG_SEP')
            };
            new SmoothPagination(pagination2, tableElement2.find('.tbody'), options);
        });
    }
    // weight
    var collapseThree = page_container.find('#collapseThree');
    var pagination3 = collapseThree.find('#pagination3');
    var tableElement3 = collapseThree.find('#tableElement3');

    const weights_chart =  page_container.find('#weights_chart')
    var weights_chartjs = null

    // tableElement click
    tableElement3.off('click');
    tableElement3.on('click', e =>
    {
        var target = $(e.target);
        if ( target.data('role') == 'DELETE' )
        {
            PromptConfirmDialog().then(c =>
            {
                // display loader
                SectionLoader(collapseThree.find('.accordion-body'));
                PATIENT_MODEL.deleteChangedSetting({
                    id: target.data('id'),
                    column: 'weight'
                }).then(response =>
                {
                    // hide loader
                    SectionLoader(collapseThree.find('.accordion-body'), '');
                    if ( response.code == 404 )	
                    {
                        ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                        return;
                    }
                    ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                    // 
                    displayWeight();
                });
            });
        }
        else if ( target.data('role') == 'PREVIEW_DOC' )
        {
            e.preventDefault();
            PreviewFileDialog({
                url: target.attr('href')
            });
        }
    });
    // collapseThree
    collapseThree.off('shown.bs.collapse');
    collapseThree.on('shown.bs.collapse', e =>
    {
        // chart
        STATISTICS_MODEL.patient_additionalData_search({
            advanced: {
                patientId: PatientObject.patientId,
                select: {
                    search: 'SELECT * FROM',
                    replace: 'SELECT weight, infoDate as date FROM',
                },
                column: {
                    name: 'weight',
                    where: `AND (weight != 'NONE')`,
                },
                groupBy: 'date',
            }
        }).then(res =>
        {
          
            if ( res.code == 404 )
            {
                weights_chart.hide(0)
                return
            }

            if ( !res.data[0].weight )
            {
                weights_chart.hide(0)
                return
            }

            weights_chart.show(0)

            var data = res.data
            var labels = []
            var values = []
            
            $.each(data, (k,v) =>
            {
                var timestamp = ''
                timestamp = v.date
                labels.push( timestamp )
                values.push( v.weight )
            })

            createPatientWeights_box_chart({
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: FUI_DISPLAY_LANG.views.pages.global.statistics.text34,
                            data: values,
                            borderColor: 'rgba(255, 184, 77, 1)',
                            backgroundColor: 'rgba(255, 184, 77, 0.2)',
                            borderWidth: 1,
                            borderRadius: 3,
                            borderSkipped: false,
                        }
                    ]
                }
            })
        })

        displayWeight();
    });

    // display weight
    function displayWeight()
    {
        // clear html
        tableElement3.find('.tbody').html('');
        // display blood pressure
        SectionLoader(collapseThree.find('.accordion-body'));
        PATIENT_MODEL.changedSettings({
            patientId: PatientObject.patientId,
            column: 'weight',
            
        }).then(response =>
        {
            // hide loader
            SectionLoader(collapseThree.find('.accordion-body'), '');
            
            if ( response.code == 404 )
                return;

            var data = response.data;
            var html = '';
            $.each(data, (k,v) =>
            {
                var doc_url = docURL(v);
                var patient_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="DOWNLOAD_FILE" download="${path.basename(doc_url)}">تحميل الملف</a>` : '';
                var preview_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="PREVIEW_DOC">فتح الملف للمعاينة</a>` : '';
                var print_doc_link = ''

                if ( doc_url != '' )
                {
                    print_doc_link = ( isImageFile(doc_url) != '') ? `<a href="${doc_url}" data-role="PRINT_DOC" class="js_trigger_print_source_url_dialog">${FUI_DISPLAY_LANG.views.pages.global.print_}</a>` : '';
                }

                if ( FUI_DISPLAY_LANG.lang == 'fr' )
                {
                    patient_doc_link = (doc_url) ? `<a href="${doc_url}" data-role="DOWNLOAD_FILE" download="${path.basename(doc_url)}">télécharger un fichier</a>` : '';
                    preview_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="PREVIEW_DOC">Ouvrir le fichier pour l'aperçu</a>` : '';
                }
                html += `<div class="tr">
                            <div class="td">${v.weight}</div>
                            <div class="td">${v.infoDate}|${v.infoTime}</div>
                            <div class="td pointer">
                                ${patient_doc_link}
                                <div>
                                    ${preview_doc_link}
                                </div>
                                <div>
                                    ${print_doc_link}    
                                </div>
                            </div>
                            <div class="td pointer">
                                <button class="btn btn-danger btn-sm" data-role="DELETE" data-id="${v.id}">
                                    <span class="no-pointer">
                                        <i class="fas fa-trash"></i>
                                    </span>
                                </button>
                            </div>
                        </div>PAG_SEP`;
            });
            // add html
            var options = {
                data: html.split('PAG_SEP')
            };
            new SmoothPagination(pagination3, tableElement3.find('.tbody'), options);
        });
    }
    // abdominal_circumference
    var collapseFour = page_container.find('#collapseFour');
    var pagination4 = collapseFour.find('#pagination4');
    var tableElement4 = collapseFour.find('#tableElement4');

    // tableElement click
    tableElement4.off('click');
    tableElement4.on('click', e =>
    {
        var target = $(e.target);
        if ( target.data('role') == 'DELETE' )
        {
            PromptConfirmDialog().then(c =>
            {
                // display loader
                SectionLoader(collapseFour.find('.accordion-body'));
                PATIENT_MODEL.deleteChangedSetting({
                    id: target.data('id'),
                    column: 'abdominal_circumference'
                }).then(response =>
                {
                    // hide loader
                    SectionLoader(collapseFour.find('.accordion-body'), '');
                    if ( response.code == 404 )	
                    {
                        ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                        return;
                    }
                    ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                    // 
                    displayAbdominal_circumference();
                });
            });
        }
        else if ( target.data('role') == 'PREVIEW_DOC' )
        {
            e.preventDefault();
            PreviewFileDialog({
                url: target.attr('href')
            });
        }
    });
    // collapseFour
    collapseFour.off('shown.bs.collapse');
    collapseFour.on('shown.bs.collapse', e =>
    {
        displayAbdominal_circumference();
    });

    // display abdominal_circumference
    function displayAbdominal_circumference()
    {
        // 
        SectionLoader(collapseFour.find('.accordion-body'));
        // clear html
        tableElement4.find('.tbody').html('');
        PATIENT_MODEL.changedSettings({
            patientId: PatientObject.patientId,
            column: 'abdominal_circumference'
        }).then(response =>
        {
            // hide loader
            SectionLoader(collapseFour.find('.accordion-body'), '');
            
            if ( response.code == 404 )
                return;

            var data = response.data;
            var html = '';
            $.each(data, (k,v) =>
            {
                var doc_url = docURL(v);
                var patient_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="DOWNLOAD_FILE" download="${path.basename(doc_url)}">تحميل الملف</a>` : '';
                var preview_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="PREVIEW_DOC">فتح الملف للمعاينة</a>` : '';
                var print_doc_link = ''

                if ( doc_url != '' )
                {
                    print_doc_link = ( isImageFile(doc_url) != '') ? `<a href="${doc_url}" data-role="PRINT_DOC" class="js_trigger_print_source_url_dialog">${FUI_DISPLAY_LANG.views.pages.global.print_}</a>` : '';
                }
                if ( FUI_DISPLAY_LANG.lang == 'fr' )
                {
                    patient_doc_link = (doc_url) ? `<a href="${doc_url}" data-role="DOWNLOAD_FILE" download="${path.basename(doc_url)}">télécharger un fichier</a>` : '';
                    preview_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="PREVIEW_DOC">Ouvrir le fichier pour l'aperçu</a>` : '';
                }
                html += `<div class="tr">
                            <div class="td">${v.abdominal_circumference}</div>
                            <div class="td">${v.infoDate}|${v.infoTime}</div>
                            <div class="td pointer">
                                ${patient_doc_link}
                                <div>
                                    ${preview_doc_link}
                                </div>
                                <div>
                                    ${print_doc_link}    
                                </div>
                            </div>
                            <div class="td pointer">
                                <button class="btn btn-danger btn-sm" data-role="DELETE" data-id="${v.id}">
                                    <span class="no-pointer">
                                        <i class="fas fa-trash"></i>
                                    </span>
                                </button>
                            </div>
                        </div>PAG_SEP`;
            });
            // add html
            var options = {
                data: html.split('PAG_SEP')
            };
            new SmoothPagination(pagination4, tableElement4.find('.tbody'), options);
        });
    }
    // chest_circumference
    var collapseNine = page_container.find('#collapseNine');
    var pagination6 = collapseNine.find('#pagination6');
    var tableElement6 = collapseNine.find('#tableElement6');
    // tableElement click
    tableElement6.off('click');
    tableElement6.on('click', e =>
    {
        var target = $(e.target);
        if ( target.data('role') == 'DELETE' )
        {
            PromptConfirmDialog().then(c =>
            {
                // display loader
                SectionLoader(collapseNine.find('.accordion-body'));
                PATIENT_MODEL.deleteChangedSetting({
                    id: target.data('id'),
                    column: 'chest_circumference'
                }).then(response =>
                {
                    // hide loader
                    SectionLoader(collapseNine.find('.accordion-body'), '');
                    if ( response.code == 404 )	
                    {
                        ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                        return;
                    }
                    ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                    // 
                    displayChest_circumference();
                });
            });
        }
        else if ( target.data('role') == 'PREVIEW_DOC' )
        {
            e.preventDefault();
            PreviewFileDialog({
                url: target.attr('href')
            });
        }
    });
    // collapseNine
    collapseNine.off('shown.bs.collapse');
    collapseNine.on('shown.bs.collapse', e =>
    {
        displayChest_circumference();
    });
    // display chest_circumference
    function displayChest_circumference()
    {
        // 
        SectionLoader(collapseNine.find('.accordion-body'));
        // clear html
        tableElement6.find('.tbody').html('');
        PATIENT_MODEL.changedSettings({
            patientId: PatientObject.patientId,
            column: 'chest_circumference'
        }).then(response =>
        {
            // hide loader
            SectionLoader(collapseNine.find('.accordion-body'), '');
            
            if ( response.code == 404 )
                return;

            var data = response.data;
            var html = '';
            $.each(data, (k,v) =>
            {
                var doc_url = docURL(v);
                var patient_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="DOWNLOAD_FILE" download="${path.basename(doc_url)}">تحميل الملف</a>` : '';
                var preview_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="PREVIEW_DOC">فتح الملف للمعاينة</a>` : '';
                var print_doc_link = ''

                if ( doc_url != '' )
                {
                    print_doc_link = ( isImageFile(doc_url) != '') ? `<a href="${doc_url}" data-role="PRINT_DOC" class="js_trigger_print_source_url_dialog">${FUI_DISPLAY_LANG.views.pages.global.print_}</a>` : '';
                }
                if ( FUI_DISPLAY_LANG.lang == 'fr' )
                {
                    patient_doc_link = (doc_url) ? `<a href="${doc_url}" data-role="DOWNLOAD_FILE" download="${path.basename(doc_url)}">télécharger un fichier</a>` : '';
                    preview_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="PREVIEW_DOC">Ouvrir le fichier pour l'aperçu</a>` : '';
                }
                html += `<div class="tr">
                            <div class="td">${v.chest_circumference}</div>
                            <div class="td">${v.infoDate}|${v.infoTime}</div>
                            <div class="td pointer">
                                ${patient_doc_link}
                                <div>
                                    ${preview_doc_link}
                                </div>
                                <div>
                                    ${print_doc_link}    
                                </div>
                            </div>
                            <div class="td pointer">
                                <button class="btn btn-danger btn-sm" data-role="DELETE" data-id="${v.id}">
                                    <span class="no-pointer">
                                        <i class="fas fa-trash"></i>
                                    </span>
                                </button>
                            </div>
                        </div>PAG_SEP`;
            });
            // add html
            var options = {
                data: html.split('PAG_SEP')
            };
            new SmoothPagination(pagination6, tableElement6.find('.tbody'), options);
        });
    }
    // arms_circumference
    var collapseTen = page_container.find('#collapseTen');
    var pagination7 = collapseTen.find('#pagination7');
    var tableElement7 = collapseTen.find('#tableElement7');
    // tableElement click
    tableElement6.off('click');
    tableElement6.on('click', e =>
    {
        var target = $(e.target);
        if ( target.data('role') == 'DELETE' )
        {
            PromptConfirmDialog().then(c =>
            {
                // display loader
                SectionLoader(collapseTen.find('.accordion-body'));
                PATIENT_MODEL.deleteChangedSetting({
                    id: target.data('id'),
                    column: 'arms_circumference'
                }).then(response =>
                {
                    // hide loader
                    SectionLoader(collapseTen.find('.accordion-body'), '');
                    if ( response.code == 404 )	
                    {
                        ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                        return;
                    }
                    ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                    // 
                    displayArms_circumference();
                });
            });
        }
        else if ( target.data('role') == 'PREVIEW_DOC' )
        {
            e.preventDefault();
            PreviewFileDialog({
                url: target.attr('href')
            });
        }
    });
    // collapseTen
    collapseTen.off('shown.bs.collapse');
    collapseTen.on('shown.bs.collapse', e =>
    {
        displayArms_circumference();
    });
    // display arms_circumference
    function displayArms_circumference()
    {
        // 
        SectionLoader(collapseTen.find('.accordion-body'));
        // clear html
        tableElement7.find('.tbody').html('');

        PATIENT_MODEL.changedSettings({
            patientId: PatientObject.patientId,
            column: 'arms_circumference'
        }).then(response =>
        {
            // hide loader
            SectionLoader(collapseTen.find('.accordion-body'), '');
            
            if ( response.code == 404 )
                return;

            var data = response.data;
            var html = '';
            $.each(data, (k,v) =>
            {
                var doc_url = docURL(v);
                var patient_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="DOWNLOAD_FILE" download="${path.basename(doc_url)}">تحميل الملف</a>` : '';
                var preview_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="PREVIEW_DOC">فتح الملف للمعاينة</a>` : '';
                var print_doc_link = ''

                if ( doc_url != '' )
                {
                    print_doc_link = ( isImageFile(doc_url) != '') ? `<a href="${doc_url}" data-role="PRINT_DOC" class="js_trigger_print_source_url_dialog">${FUI_DISPLAY_LANG.views.pages.global.print_}</a>` : '';
                }
                if ( FUI_DISPLAY_LANG.lang == 'fr' )
                {
                    patient_doc_link = (doc_url) ? `<a href="${doc_url}" data-role="DOWNLOAD_FILE" download="${path.basename(doc_url)}">télécharger un fichier</a>` : '';
                    preview_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="PREVIEW_DOC">Ouvrir le fichier pour l'aperçu</a>` : '';
                }
                html += `<div class="tr">
                            <div class="td">${v.arms_circumference}</div>
                            <div class="td">${v.infoDate}|${v.infoTime}</div>
                            <div class="td pointer">
                                ${patient_doc_link}
                                <div>
                                    ${preview_doc_link}
                                </div>
                                <div>
                                    ${print_doc_link}    
                                </div>
                            </div>
                            <div class="td pointer">
                                <button class="btn btn-danger btn-sm" data-role="DELETE" data-id="${v.id}">
                                    <span class="no-pointer">
                                        <i class="fas fa-trash"></i>
                                    </span>
                                </button>
                            </div>
                        </div>PAG_SEP`;
            });
            // add html
            var options = {
                data: html.split('PAG_SEP')
            };
            new SmoothPagination(pagination7, tableElement7.find('.tbody'), options);
        });
    }
    // insulin
    var collapseEight = page_container.find('#collapseEight');
    var pagination5 = collapseEight.find('#pagination5');
    var tableElement5 = collapseEight.find('#tableElement5');
    // tableElement click
    tableElement5.off('click');
    tableElement5.on('click', e =>
    {
        var target = $(e.target);
        if ( target.data('role') == 'DELETE' )
        {
            PromptConfirmDialog().then(c =>
            {
                // display loader
                SectionLoader(collapseEight.find('.accordion-body'));
                PATIENT_MODEL.deleteChangedSetting({
                    id: target.data('id'),
                    column: 'insulin'
                }).then(response =>
                {
                    // hide loader
                    SectionLoader(collapseEight.find('.accordion-body'), '');
                    if ( response.code == 404 )	
                    {
                        ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                        return;
                    }
                    ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                    // 
                    displayInsulin();
                });
            });
        }
        else if ( target.data('role') == 'PREVIEW_DOC' )
        {
            e.preventDefault();
            PreviewFileDialog({
                url: target.attr('href')
            });
        }
    });
    // collapseEight
    collapseEight.off('shown.bs.collapse');
    collapseEight.on('shown.bs.collapse', e =>
    {
        displayInsulin();
    });
    // display insulin
    function displayInsulin()
    {
        // 
        SectionLoader(collapseEight.find('.accordion-body'));
        // clear html
        tableElement5.find('.tbody').html('');

        PATIENT_MODEL.changedSettings({
            patientId: PatientObject.patientId,
            column: 'insulin'
        }).then(response =>
        {
            // hide loader
            SectionLoader(collapseEight.find('.accordion-body'), '');
            
            if ( response.code == 404 )
                return;

            var data = response.data;
            var html = '';
            $.each(data, (k,v) =>
            {
                var doc_url = docURL(v);
                var patient_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="DOWNLOAD_FILE" download="${path.basename(doc_url)}">تحميل الملف</a>` : '';
                var preview_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="PREVIEW_DOC">فتح الملف للمعاينة</a>` : '';
                var print_doc_link = ''

                if ( doc_url != '' )
                {
                    print_doc_link = ( isImageFile(doc_url) != '') ? `<a href="${doc_url}" data-role="PRINT_DOC" class="js_trigger_print_source_url_dialog">${FUI_DISPLAY_LANG.views.pages.global.print_}</a>` : '';
                }
                if ( FUI_DISPLAY_LANG.lang == 'fr' )
                {
                    patient_doc_link = (doc_url) ? `<a href="${doc_url}" data-role="DOWNLOAD_FILE" download="${path.basename(doc_url)}">télécharger un fichier</a>` : '';
                    preview_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="PREVIEW_DOC">Ouvrir le fichier pour l'aperçu</a>` : '';
                }
                html += `<div class="tr">
                            <div class="td">${v.insulin}</div>
                            <div class="td">${v.infoDate}|${v.infoTime}</div>
                            <div class="td pointer">
                                ${patient_doc_link}
                                <div>
                                    ${preview_doc_link}
                                </div>
                                <div>
                                    ${print_doc_link}    
                                </div>
                            </div>
                            <div class="td pointer">
                                <button class="btn btn-danger btn-sm" data-role="DELETE" data-id="${v.id}">
                                    <span class="no-pointer">
                                        <i class="fas fa-trash"></i>
                                    </span>
                                </button>
                            </div>
                        </div>PAG_SEP`;
            });
            // add html
            var options = {
                data: html.split('PAG_SEP')
            };
            new SmoothPagination(pagination5, tableElement5.find('.tbody'), options);
        });
    }
    // TSH
    var collapse11 = page_container.find('#collapse11');
    var pagination8 = collapse11.find('#pagination8');
    var tableElement8 = collapse11.find('#tableElement8');
    // tableElement click
    tableElement8.off('click');
    tableElement8.on('click', e =>
    {
        var target = $(e.target);
        if ( target.data('role') == 'DELETE' )
        {
            PromptConfirmDialog().then(c =>
            {
                // display loader
                SectionLoader(collapse11.find('.accordion-body'));
                PATIENT_MODEL.deleteChangedSetting({
                    id: target.data('id'),
                    column: 'TSH'
                }).then(response =>
                {
                    // hide loader
                    SectionLoader(collapse11.find('.accordion-body'), '');
                    if ( response.code == 404 )	
                    {
                        ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                        return;
                    }
                    ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                    // 
                    displayTSH();
                });
            });
        }
        else if ( target.data('role') == 'PREVIEW_DOC' )
        {
            e.preventDefault();
            PreviewFileDialog({
                url: target.attr('href')
            });
        }
    });
    // collapse11
    collapse11.off('shown.bs.collapse');
    collapse11.on('shown.bs.collapse', e =>
    {
        displayTSH();
    });
    // display TSH
    function displayTSH()
    {
        // 
        SectionLoader(collapse11.find('.accordion-body'));
        // clear html
        tableElement8.find('.tbody').html('');

        PATIENT_MODEL.changedSettings({
            patientId: PatientObject.patientId,
            column: 'TSH'
        }).then(response =>
        {
            // hide loader
            SectionLoader(collapse11.find('.accordion-body'), '');
            
            if ( response.code == 404 )
                return;

            var data = response.data;
            var html = '';
            $.each(data, (k,v) =>
            {
                var doc_url = docURL(v);
                var patient_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="DOWNLOAD_FILE" download="${path.basename(doc_url)}">تحميل الملف</a>` : '';
                var preview_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="PREVIEW_DOC">فتح الملف للمعاينة</a>` : '';
                var print_doc_link = ''

                if ( doc_url != '' )
                {
                    print_doc_link = ( isImageFile(doc_url) != '') ? `<a href="${doc_url}" data-role="PRINT_DOC" class="js_trigger_print_source_url_dialog">${FUI_DISPLAY_LANG.views.pages.global.print_}</a>` : '';
                }
                if ( FUI_DISPLAY_LANG.lang == 'fr' )
                {
                    patient_doc_link = (doc_url) ? `<a href="${doc_url}" data-role="DOWNLOAD_FILE" download="${path.basename(doc_url)}">télécharger un fichier</a>` : '';
                    preview_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="PREVIEW_DOC">Ouvrir le fichier pour l'aperçu</a>` : '';
                }
                html += `<div class="tr">
                            <div class="td">${v.TSH}</div>
                            <div class="td">${v.infoDate}|${v.infoTime}</div>
                            <div class="td pointer">
                                ${patient_doc_link}
                                <div>
                                    ${preview_doc_link}
                                </div>
                                <div>
                                    ${print_doc_link}    
                                </div>
                            </div>
                            <div class="td pointer">
                                <button class="btn btn-danger btn-sm" data-role="DELETE" data-id="${v.id}">
                                    <span class="no-pointer">
                                        <i class="fas fa-trash"></i>
                                    </span>
                                </button>
                            </div>
                        </div>PAG_SEP`;
            });
            // add html
            var options = {
                data: html.split('PAG_SEP')
            };
            new SmoothPagination(pagination8, tableElement8.find('.tbody'), options);
        });
    }
    // HBA1c
    var collapse12 = page_container.find('#collapse12');
    var pagination9 = collapse12.find('#pagination9');
    var tableElement9 = collapse12.find('#tableElement9');
    // tableElement click
    tableElement9.off('click');
    tableElement9.on('click', e =>
    {
        var target = $(e.target);
        if ( target.data('role') == 'DELETE' )
        {
            PromptConfirmDialog().then(c =>
            {
                // display loader
                SectionLoader(collapse12.find('.accordion-body'));
                PATIENT_MODEL.deleteChangedSetting({
                    id: target.data('id'),
                    column: 'HBA1c'
                }).then(response =>
                {
                    // hide loader
                    SectionLoader(collapse12.find('.accordion-body'), '');
                    if ( response.code == 404 )	
                    {
                        ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                        return;
                    }
                    ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                    // 
                    displayHBA1c();
                });
            });
        }
        else if ( target.data('role') == 'PREVIEW_DOC' )
        {
            e.preventDefault();
            PreviewFileDialog({
                url: target.attr('href')
            });
        }
    });
    // collapse12
    collapse12.off('shown.bs.collapse');
    collapse12.on('shown.bs.collapse', e =>
    {
        displayHBA1c();
    });
    // display HBA1c
    function displayHBA1c()
    {
        // 
        SectionLoader(collapse12.find('.accordion-body'));
        // clear html
        tableElement9.find('.tbody').html('');

        PATIENT_MODEL.changedSettings({
            patientId: PatientObject.patientId,
            column: 'HBA1c'
        }).then(response =>
        {
            // hide loader
            SectionLoader(collapse12.find('.accordion-body'), '');
            
            if ( response.code == 404 )
                return;

            var data = response.data;
            var html = '';
            $.each(data, (k,v) =>
            {
                var doc_url = docURL(v);
                var patient_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="DOWNLOAD_FILE" download="${path.basename(doc_url)}">تحميل الملف</a>` : '';
                var preview_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="PREVIEW_DOC">فتح الملف للمعاينة</a>` : '';
                var print_doc_link = ''

                if ( doc_url != '' )
                {
                    print_doc_link = ( isImageFile(doc_url) != '') ? `<a href="${doc_url}" data-role="PRINT_DOC" class="js_trigger_print_source_url_dialog">${FUI_DISPLAY_LANG.views.pages.global.print_}</a>` : '';
                }
                if ( FUI_DISPLAY_LANG.lang == 'fr' )
                {
                    patient_doc_link = (doc_url) ? `<a href="${doc_url}" data-role="DOWNLOAD_FILE" download="${path.basename(doc_url)}">télécharger un fichier</a>` : '';
                    preview_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="PREVIEW_DOC">Ouvrir le fichier pour l'aperçu</a>` : '';
                }
                html += `<div class="tr">
                            <div class="td">${v.HBA1c}</div>
                            <div class="td">${v.infoDate}|${v.infoTime}</div>
                            <div class="td pointer">
                                ${patient_doc_link}
                                <div>
                                    ${preview_doc_link}
                                </div>
                                <div>
                                    ${print_doc_link}    
                                </div>
                            </div>
                            <div class="td pointer">
                                <button class="btn btn-danger btn-sm" data-role="DELETE" data-id="${v.id}">
                                    <span class="no-pointer">
                                        <i class="fas fa-trash"></i>
                                    </span>
                                </button>
                            </div>
                        </div>PAG_SEP`;
            });
            // add html
            var options = {
                data: html.split('PAG_SEP')
            };
            new SmoothPagination(pagination9, tableElement9.find('.tbody'), options);
        });
    }
    // VS
    var collapse13 = page_container.find('#collapse13');
    var pagination10 = collapse13.find('#pagination10');
    var tableElement10 = collapse13.find('#tableElement10');
    // tableElement click
    tableElement10.off('click');
    tableElement10.on('click', e =>
    {
        var target = $(e.target);
        if ( target.data('role') == 'DELETE' )
        {
            PromptConfirmDialog().then(c =>
            {
                // display loader
                SectionLoader(collapse13.find('.accordion-body'));
                PATIENT_MODEL.deleteChangedSetting({
                    id: target.data('id'),
                    column: 'VS'
                }).then(response =>
                {
                    // hide loader
                    SectionLoader(collapse13.find('.accordion-body'), '');
                    if ( response.code == 404 )	
                    {
                        ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                        return;
                    }
                    ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                    // 
                    displayVS();
                });
            });
        }
        else if ( target.data('role') == 'PREVIEW_DOC' )
        {
            e.preventDefault();
            PreviewFileDialog({
                url: target.attr('href')
            });
        }
    });
    // collapse13
    collapse13.off('shown.bs.collapse');
    collapse13.on('shown.bs.collapse', e =>
    {
        displayVS();
    });
    // display VS
    function displayVS()
    {
        // 
        SectionLoader(collapse13.find('.accordion-body'));
        // clear html
        tableElement10.find('.tbody').html('');

        PATIENT_MODEL.changedSettings({
            patientId: PatientObject.patientId,
            column: 'VS'
        }).then(response =>
        {
            // hide loader
            SectionLoader(collapse13.find('.accordion-body'), '');
            
            if ( response.code == 404 )
                return;

            var data = response.data;
            var html = '';
            $.each(data, (k,v) =>
            {
                var doc_url = docURL(v);
                var patient_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="DOWNLOAD_FILE" download="${path.basename(doc_url)}">تحميل الملف</a>` : '';
                var preview_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="PREVIEW_DOC">فتح الملف للمعاينة</a>` : '';
                var print_doc_link = ''

                if ( doc_url != '' )
                {
                    print_doc_link = ( isImageFile(doc_url) != '') ? `<a href="${doc_url}" data-role="PRINT_DOC" class="js_trigger_print_source_url_dialog">${FUI_DISPLAY_LANG.views.pages.global.print_}</a>` : '';
                }
                if ( FUI_DISPLAY_LANG.lang == 'fr' )
                {
                    patient_doc_link = (doc_url) ? `<a href="${doc_url}" data-role="DOWNLOAD_FILE" download="${path.basename(doc_url)}">télécharger un fichier</a>` : '';
                    preview_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="PREVIEW_DOC">Ouvrir le fichier pour l'aperçu</a>` : '';
                }
                html += `<div class="tr">
                            <div class="td">${v.VS}</div>
                            <div class="td">${v.infoDate}|${v.infoTime}</div>
                            <div class="td pointer">
                                ${patient_doc_link}
                                <div>
                                    ${preview_doc_link}
                                </div>
                                <div>
                                    ${print_doc_link}    
                                </div>
                            </div>
                            <div class="td pointer">
                                <button class="btn btn-danger btn-sm" data-role="DELETE" data-id="${v.id}">
                                    <span class="no-pointer">
                                        <i class="fas fa-trash"></i>
                                    </span>
                                </button>
                            </div>
                        </div>PAG_SEP`;
            });
            // add html
            var options = {
                data: html.split('PAG_SEP')
            };
            new SmoothPagination(pagination10, tableElement10.find('.tbody'), options);
        });
    }
    // CRP
    var collapse14 = page_container.find('#collapse14');
    var pagination11 = collapse14.find('#pagination11');
    var tableElement11 = collapse14.find('#tableElement11');
    // tableElement click
    tableElement11.off('click');
    tableElement11.on('click', e =>
    {
        var target = $(e.target);
        if ( target.data('role') == 'DELETE' )
        {
            PromptConfirmDialog().then(c =>
            {
                // display loader
                SectionLoader(collapse14.find('.accordion-body'));
                PATIENT_MODEL.deleteChangedSetting({
                    id: target.data('id'),
                    column: 'CRP'
                }).then(response =>
                {
                    // hide loader
                    SectionLoader(collapse14.find('.accordion-body'), '');
                    if ( response.code == 404 )	
                    {
                        ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                        return;
                    }
                    ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                    // 
                    displayCRP();
                });
            });
        }
        else if ( target.data('role') == 'PREVIEW_DOC' )
        {
            e.preventDefault();
            PreviewFileDialog({
                url: target.attr('href')
            });
        }
    });
    // collapse14
    collapse14.off('shown.bs.collapse');
    collapse14.on('shown.bs.collapse', e =>
    {
        displayCRP();
    });
    // display CRP
    function displayCRP()
    {
        // 
        SectionLoader(collapse14.find('.accordion-body'));
        // clear html
        tableElement11.find('.tbody').html('');

        PATIENT_MODEL.changedSettings({
            patientId: PatientObject.patientId,
            column: 'CRP'
        }).then(response =>
        {
            // hide loader
            SectionLoader(collapse14.find('.accordion-body'), '');
            
            if ( response.code == 404 )
                return;

            var data = response.data;
            var html = '';
            $.each(data, (k,v) =>
            {
                var doc_url = docURL(v);
                var patient_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="DOWNLOAD_FILE" download="${path.basename(doc_url)}">تحميل الملف</a>` : '';
                var preview_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="PREVIEW_DOC">فتح الملف للمعاينة</a>` : '';
                var print_doc_link = ''

                if ( doc_url != '' )
                {
                    print_doc_link = ( isImageFile(doc_url) != '') ? `<a href="${doc_url}" data-role="PRINT_DOC" class="js_trigger_print_source_url_dialog">${FUI_DISPLAY_LANG.views.pages.global.print_}</a>` : '';
                }
                if ( FUI_DISPLAY_LANG.lang == 'fr' )
                {
                    patient_doc_link = (doc_url) ? `<a href="${doc_url}" data-role="DOWNLOAD_FILE" download="${path.basename(doc_url)}">télécharger un fichier</a>` : '';
                    preview_doc_link = (doc_url != '') ? `<a href="${doc_url}" data-role="PREVIEW_DOC">Ouvrir le fichier pour l'aperçu</a>` : '';
                }
                html += `<div class="tr">
                            <div class="td">${v.CRP}</div>
                            <div class="td">${v.infoDate}|${v.infoTime}</div>
                            <div class="td pointer">
                                ${patient_doc_link}
                                <div>
                                    ${preview_doc_link}
                                </div>
                                <div>
                                    ${print_doc_link}    
                                </div>
                            </div>
                            <div class="td pointer">
                                <button class="btn btn-danger btn-sm" data-role="DELETE" data-id="${v.id}">
                                    <span class="no-pointer">
                                        <i class="fas fa-trash"></i>
                                    </span>
                                </button>
                            </div>
                        </div>PAG_SEP`;
            });
            // add html
            var options = {
                data: html.split('PAG_SEP')
            };
            new SmoothPagination(pagination11, tableElement11.find('.tbody'), options);
        });
    }
    // Medical_test
    var collapse15 = page_container.find('#collapse15');
    var medicalTestsImagesCarousel = collapse15.find('#medicalTestsImagesCarousel');
    // tableElement click
    medicalTestsImagesCarousel.off('click');
    medicalTestsImagesCarousel.on('click', e =>
    {
        var target = $(e.target);
        if ( target.data('role') == 'DELETE' )
        {
            PromptConfirmDialog().then(async c =>
            {
                // display loader
                SectionLoader(collapse15.find('.accordion-body'));
                var response = await PATIENT_MODEL.medicalTest_delete(target.data('id'));
                // hide loader
                SectionLoader(collapse15.find('.accordion-body'), '');
                if ( response.code == 404 )	
                {
                    ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                    return;
                }
                ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                // 
                displayMedicalTests();
            });
        }
        else if ( target.data('role') == 'PREVIEW_DOC' )
        {
            e.preventDefault();
            PreviewFileDialog({
                url: target.attr('href')
            });
        }
    });
    // collapse15
    collapse15.off('shown.bs.collapse');
    collapse15.on('shown.bs.collapse', e =>
    {
        displayMedicalTests();
    });
    // displayMedicalTests
    function displayMedicalTests()
    {
        // 
        SectionLoader(collapse15.find('.accordion-body'));
        medicalTestsImagesCarousel.find('.carousel-inner').html('');

        PATIENT_MODEL.medicalTest_index(PatientObject.patientId).then(response =>
        {
            // hide loader
            SectionLoader(collapse15.find('.accordion-body'), '');
            
            if ( response.code == 404 )
                return;

            var data = response.data;
            var html = '';
            for (let i = 0; i < data.length; i++) 
            {
                const v = data[i];
                html+= `<div class="carousel-item" data-bs-interval="2000">
                            <button class="btn-close position-relative" data-role="DELETE" data-id="${v.id}" style="z-index:30;"></button>
                            <div class="row gx-0 gy-0">`;
                for (let j = 0; j < v.album.length; j++) 
                {
                    const album = v.album[j];
                    var image = JSON.parse(album.image);
                    
                    html += `<div class="col">
                                <figure class="figure position-relative h-100">
                                    <div class="figure-overlay">
                                        <div class="btn-group btn-group-sm">
                                            <a href="${image.url}" class="btn btn-light rounded-0" download="${path.basename(image.fullpath)}" data-file=""><i class="fas fa-download"></i></a>
                                            <a href="${image.url}" class="btn btn-light rounded-0" data-role="PREVIEW_DOC"><i class="fas fa-eye no-pointer"></i></a>
                                        </div>
                                        <div class="figure-caption mt-3 text-white">${v.created_at_date} | ${v.created_at_time}</div>
                                    </div> 
                                    <div class="figure-content h-100">
                                        <img src="${image.url}" class="img-fluid img-thumbnail h-100" alt="...">
                                    </div>
                                </figure>
                            </div>`;
                }
                html+= `	</div>
                        </div>`;
            }
            medicalTestsImagesCarousel.find('.carousel-inner').html(html)
            .find('.carousel-item').first().addClass('active');
        });
    }
    // Albums
    var collapse16 = page_container.find('#collapse16');
    var albumsCarousel = collapse16.find('#albumsCarousel');
    // tableElement click
    albumsCarousel.off('click');
    albumsCarousel.on('click', e =>
    {
        var target = $(e.target);
        if ( target.data('role') == 'DELETE' )
        {
            PromptConfirmDialog().then(async c =>
            {
                // display loader
                SectionLoader(collapse16.find('.accordion-body'));
                var response = await PATIENT_MODEL.album_delete(target.data('id'));
                // hide loader
                SectionLoader(collapse16.find('.accordion-body'), '');
                if ( response.code == 404 )	
                {
                    ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                    return;
                }
                ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                // 
                displayAlbums();
            });
        }
        else if ( target.data('role') == 'PREVIEW_DOC' )
        {
            e.preventDefault();
            PreviewFileDialog({
                url: target.attr('href')
            });
        }
    });
    // collapse16
    collapse16.off('shown.bs.collapse');
    collapse16.on('shown.bs.collapse', e =>
    {
        displayAlbums();
    });
    // displayAlbums
    async function displayAlbums()
    {
        // 
        SectionLoader(collapse16.find('.accordion-body'));
        albumsCarousel.find('.carousel-inner').html('');

        var response = await PATIENT_MODEL.album_index(PatientObject.patientId);
        // hide loader
        SectionLoader(collapse16.find('.accordion-body'), '');
        
        if ( response.code == 404 )
            return;

        var data = response.data;
        var html = '';
        for (let i = 0; i < data.length; i++) 
        {
            const v = data[i];
            html+= `<div class="carousel-item" data-bs-interval="2000">
                        <button class="btn-close position-relative" data-role="DELETE" data-id="${v.id}" style="z-index:30;"></button>
                        <div class="row gx-0 gy-0">`;
            for (let j = 0; j < v.photos.length; j++) 
            {
                const photo = v.photos[j];
                var image = JSON.parse(photo.image);
                
                html += `<div class="col">
                            <figure class="figure position-relative h-100">
                                <div class="figure-overlay">
                                    <div class="btn-group btn-group-sm">
                                        <a href="${image.url}" class="btn btn-light rounded-0" download="${path.basename(image.fullpath)}" data-file=""><i class="fas fa-download"></i></a>
                                        <a href="${image.url}" class="btn btn-light rounded-0" data-role="PREVIEW_DOC"><i class="fas fa-eye no-pointer"></i></a>
                                    </div>
                                    <div class="figure-caption mt-3 text-white">${v.created_at_date} | ${v.created_at_time}</div>
                                </div> 
                                <div class="figure-content h-100">
                                    <img src="${image.url}" class="img-fluid img-thumbnail h-100" alt="...">
                                </div>
                            </figure>
                        </div>`;
            }
            html+= `	</div>
                    </div>`;
        }
        albumsCarousel.find('.carousel-inner').html(html)
        .find('.carousel-item').first().addClass('active');
    }
    
    // view_patient_partial_body_analisys
    var collapse17 = page_container.find('#collapse17');
    var view_patient_partial_body_analisys_carousel = collapse17.find('#view_patient_partial_body_analisys_carousel');
    // tableElement click
    view_patient_partial_body_analisys_carousel.on('click', e =>
    {
        var target = $(e.target);
        if ( target.data('role') == 'DELETE' )
        {
            PromptConfirmDialog().then(async c =>
            {
                // display loader
                SectionLoader(collapse17.find('.accordion-body'));
                var response = await PATIENT_MODEL.partial_body_analisys__delete({
                    id: target.data('id')
                });
                // hide loader
                SectionLoader(collapse17.find('.accordion-body'), '');
                if ( response.code == 404 )	
                {
                    ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                    return;
                }
                ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message);
                // 
                displayPartialBodyAnalisys();
            });
        }
        else if ( target.data('role') == 'PREVIEW_DOC' )
        {
            e.preventDefault();
            PreviewFileDialog({
                url: target.attr('href')
            });
        }
    });
    // collapse17
    collapse17.off('shown.bs.collapse');
    collapse17.on('shown.bs.collapse', e =>
    {
        displayPartialBodyAnalisys();
    });
    // displayPartialBodyAnalisys
    async function displayPartialBodyAnalisys()
    {
        // 
        SectionLoader(collapse17.find('.accordion-body'));
        view_patient_partial_body_analisys_carousel.find('.carousel-inner').html('');

        var response = await PATIENT_MODEL.partial_body_analisys__search({
            query: '',
            advanced: {
                patientId: PatientObject.patientId,
                orderBy: 'id',
                order: 'desc',
            }
        });
        // hide loader
        SectionLoader(collapse17.find('.accordion-body'), '');
        
        if ( response.code == 404 )
            return;

        var data = response.data;
        var html = '';
        for (let i = 0; i < data.length; i++) 
        {
            const v = data[i];
            html+= `<div class="carousel-item" data-bs-interval="2000">
                        <button class="btn-close position-relative" data-role="DELETE" data-id="${v.id}" data-perm="delete_patient_partial_body_analisys" style="z-index:30;"></button>
                        <div class="row gx-0 gy-0">`;
            for (let j = 0; j < v.files.length; j++) 
            {
                const file = v.files[j];
                html += `<div class="col-md-12">
                            <iframe src="${file.url}" class="w-100 height-100vh"></iframe>
                        </div>`;
            }
            html+= `	</div>
                    </div>`;
        }
        view_patient_partial_body_analisys_carousel.find('.carousel-inner').html(html)
        .find('.carousel-item').first().addClass('active');
    }
    // view_patient_reports
    var collapse18 = page_container.find('#collapse18');

    var view_patient_reports__deleteSelectedBTN = page_container.find('#view_patient_reports__deleteSelectedBTN')
    var view_patient_reports__search_btn = page_container.find('#view_patient_reports__search_btn')
    var view_patient_reports__search_input = page_container.find('#view_patient_reports__search_input')
    var view_patient_reports__date_start_input = page_container.find('#view_patient_reports__date_start_input')
    var view_patient_reports__date_end_input = page_container.find('#view_patient_reports__date_end_input')

    var view_patient_reports__pagination = page_container.find('#view_patient_reports__pagination')
    var view_patient_reports__tableElement = page_container.find('#view_patient_reports__tableElement')

    // collapse18
    collapse18.off('shown.bs.collapse');
    collapse18.on('shown.bs.collapse', e =>
    {
        view_patient_reports__search_input.trigger('keyup')
    })

    // delete selected
    view_patient_reports__deleteSelectedBTN.on('click', e =>
    {
        PromptConfirmDialog().then(async c =>
        {
            view_patient_reports__deleteSelectedBTN.addClass('disabled')
            var response = await PATIENT_MODEL.report_batchDelete({
                collection: view_patient_reports__selectedRows()
            })

            view_patient_reports__deleteSelectedBTN.removeClass('disabled')
            ERROR_BOX.show(0).delay(7*1000).hide(0).find('#text').text(response.message)

            if ( response.code == 404 ) return 

            view_patient_reports__search_input.trigger('keyup')
        })
    })
    // tableElement
    view_patient_reports__tableElement.on('click', async e =>
    {
        var target = $(e.target)

        if ( target.data('role') == 'UPDATE' )
        {
            var parent = target.closest('[data-role="row"]')

            var res = await PATIENT_MODEL.report_show({
                id: parent.data('id'),
            })

            goToPage('create-patient-reports', res.data)
        }
        else if ( target.data('role') == 'OPEN' )
        {
            var parent = target.closest('[data-role="row"]')

            var res = await PATIENT_MODEL.report_show({
                id: parent.data('id'),
            })
            
            var data = res.data

            dialog = new FullpageDialog({
                container: 'patient_report_dialog',
                title: `${data.patientName} (${data.patientPhone})`,
                html: `<ul class="list-group list-group-flush mb-3">
                            <li class="list-group-item">
                                <span class="fw-500">${ FUI_DISPLAY_LANG.views.pages.global.text64 }: </span>
                                <span>${data.employee_name}</span>
                            </li>
                        </ul>
                        <div class="border-top rounded py-3 px-2">
                            ${data.body}    
                        </div>`,
                size: {
                    maxWidth: '550px',
                    maxHeight: '500px',
                }
            })

            dialog.getElement().find('.dialog_container').css('padding', '2em 0')
        }
    })
    // search
    view_patient_reports__search_btn.on('click', e =>
    {
        view_patient_reports__displayAll({
            method_type: 'report_search',
            query: view_patient_reports__search_input.val(),
            advanced: {
                start: view_patient_reports__date_start_input.val(),
                end: view_patient_reports__date_end_input.val(),
                clinicId: PatientObject.clinicId,
                patientId: PatientObject.patientId,
            }
        })
    })
    view_patient_reports__search_input.on('keyup', e =>
    {
        view_patient_reports__displayAll({
            method_type: 'report_search',
            query: view_patient_reports__search_input.val(),
            advanced: {
                clinicId: PatientObject.clinicId,
                patientId: PatientObject.patientId,
            }
        })
    })
    // view_patient_reports__search_input.trigger('keyup')

    // display all
    async function view_patient_reports__displayAll(params)
    {
        SectionLoader(view_patient_reports__tableElement)

        view_patient_reports__tableElement.find('.tbody').html('')

        if ( params.method_type == 'report_search' ) var res = await PATIENT_MODEL.report_search(params)

        SectionLoader(view_patient_reports__tableElement, '')

        if ( res.code == 404 ) return

        var data = res.data
        var last_data = firstArrayElement(data)
        var html = ''

        $.each(data, (k,v) =>
        {
            html += `<div class="tr" data-role="row" data-id="${v.id}">
                        <div class="td">
                            <input type="checkbox" class="form-check-input pointer" data-role="CHECK">
                        </div>
                        <div class="td">
                            <a href="#" data-role="OPEN" class="pointer">${ strSnippet(v.body) }</a>
                        </div>
                        <div class="td">
                            <div class=">${v.created_at}</div>	
                        </div>
                    </div>PAG_SEP`
        })

        new SmoothPagination(view_patient_reports__pagination, view_patient_reports__tableElement.find('.tbody'), {
            data: html.split('PAG_SEP'),
        })

    }
    // selected rows
    function view_patient_reports__selectedRows()
    {
        var list = [];
        var items = view_patient_reports__tableElement.find('[data-role="row"]');
        for (var i = 0; i < items.length; i++) 
        {
            var parent = page_container.find(items[i])
            var check = parent.find('[data-role="CHECK"]')
            if ( check.is(':checked') )
            {
                list.push({
                    id: parent.data('id'),
                })
            }
        }

        return list;
    }

    
    // Charts
    // create chart
    function createPatientWeights_box_chart(options = {})
    {
        const ctx = weights_chart[0].getContext('2d');

        const config = {
            type: 'line',
            data: options.data,
            options: {
                responsive: true,
                height: 500,
                plugins: {
                    legend: {
                        position: 'top',
                    },
                    title: {
                        display: true,
                        text: FUI_DISPLAY_LANG.views.pages.global.statistics.text28
                    }
                }
            },
        }

        if ( weights_chartjs ) weights_chartjs.destroy()

        weights_chartjs = new Chart(ctx, config)
                
    }
}
// parse doc_object
function docURL(data)
{
    if ( data.doc_object )
        return JSON.parse(data.doc_object).url;
    else
        return '';
}

})

</script>